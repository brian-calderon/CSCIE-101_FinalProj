#install.packages("fastDummies")
library(ISLR2)
library(tidyverse)
library(caret)
library(MASS)
library(fastDummies)
library(stringr)
odata<- read.csv("Titanic_Survival_Data.csv")
cat("Size of entire data set:", nrow(odata), "\n")

#Remove Unneeded Columns'
data <- odata[, !(names(odata) %in% c("name", "ticket", "boat","body","home.dest"))]

#Replace NAs in age column with Median value 
median_age <- median(data$age, na.rm = TRUE)
data <- data %>%
  mutate(age = ifelse(is.na(age), median_age, age))

#Extract deck letter from cabin
data$deck <- substr(data$cabin, 1,1)
data$cabin <- NULL

#Create dummy variables
data <- data %>%
  fastDummies :: dummy_cols(select_columns = c("sex", "embarked","deck"),
                            remove_selected_columns = TRUE)

Remove NAs
data <-na.omit(data)
#head(data)
set.seed(15)

#split data into train and test
datasplit <- data %>%
  group_by(survived) %>%
  group_split() %>%
  lapply(function(df) sample(seq_len(nrow(df)), size = 0.7 * nrow(df))) %>%
  unlist()

data_train<-data[datasplit,]
data_test<-data[-datasplit,]

#check the data
cat("Training data set size:", nrow(data_train), "\n")
cat("Testing data set size:", nrow(data_test), "\n")
cat("Size of entire data set:", nrow(data), "\n")
head(data)
